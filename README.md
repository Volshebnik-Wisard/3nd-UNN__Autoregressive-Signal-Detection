# Обнаружение гармонического сигнала методом авторегрессии
### Цель учебной задачи

Авторегрессионная модель сегодня является очень популярной моделью для описания сигналов благодаря её простоте и линейности относительно параметров. Следствием этой модели является то, что можно предсказать сигнал на основе предыдущих его отсчётов. Этим можно пользоваться для обнаружения синусоидального сигнала заданной частоты, что само по себе также является актуальной прикладной задачей, играющей важную роль в теории оптимального приёма сигналов.

## Постановка задачи

В данной задаче требуется оценить границы фрагмента эталонного гармонического сигнала с известной частотой, расположенного внутри массива, содержащего гармонические сигналы с другими частотами. На первом этапе реализации алгоритма обнаружения эталонного сигнала необходимо сгенерировать исследуемый сигнал. Для этого задаются частоты исходного гармонического сигнала для обнаружения и двух других синусоидальных сигналов, между которыми заключён искомый сигнал. Рекомендуется использовать единичную амплитуду для всех сигналов. С учётом заданных границ (начала и конца) $n_1$ и $n_2$ участка эталонного сигнала исследуемый сигнал будет определяться как:

$$
x[t] = \begin{cases} 
\sin(2\pi f_1 t) & t < n_1 \\ 
\sin(2\pi f_0 t) & t \geq n_1 \text{ и } t \leq n_2 \\ 
\sin(2\pi f_2 t) & t > n_2 \end{cases}
$$

Количество отсчётов может быть произвольным, рекомендуется брать $N ~ 1000$ отсчётов. Дополнительно при генерации исследуемого сигнала необходимо обеспечить непрерывность фазы (производить «сшивку» фазы на участках перехода от одного гармонического сигнала к другому), чтобы получился один плавный график трёх сигналов с разными частотами.

В данной задаче используется линейное предсказание для обнаружения сигнала заданной частоты $f_0$. Линейное предсказание использует АР-модель.

Из теории известно, что для представления синусоидального сигнала без шума в АР-модели необходим порядок $p = 2$. Это означает, что необходимо составить и аналитически решить систему нормальных уравнений Юла-Уокера для нахождения двух параметров $a_1$ и $a_2$ для гармонического сигнала заданной частоты $f_0$. При этом значение $ρ_ω$ в правой части будем полагать равным нулю.

Отсчёты исследуемого сигнала подставляются в формулу АР-модели второго порядка для линейного предсказания. Работа алгоритма предсказания начинается с третьего отсчета, поскольку предсказание зависит от двух предыдущих отсчётов. На основе полученных предсказанных отсчетов и имеющихся истинных отсчетов исследуемого сигнала вычисляется массив квадратичных ошибок предсказания, т.е. график квадратичного отклонения между предсказанием и фактическим отсчётом исходного сигнала. Определить границы искомого сигнала можно пороговым методом, для чего нужно сглаживать ошибку предсказания.

В данной задаче для сглаживания данных предлагается использовать алгоритм свёрточной фильтрации во временной области. В скользящем по массиву квадратичных ошибок предсказания прямоугольном окне заданной ширины $L$ производится вычисление среднего значения отсчётов, которые охватывает окно.

Точки пересечения линии заданного порога с графиком сглаженной ошибки будем считать оценкой начала и конца искомого эталонного сигнала, соответственно.

## **Среда разработки**
- Visual Studio 2022 с компонентами:
  - "Разработка классических приложений на C++"
  - "Пакет SDK для Windows 10/11"
  - "MSVC версии 141 - средства сборки C++"
  - "MSVC версии 141 - библиотеки C++"

## Результат работы программы
![bandicam 2026-02-11 19-30-23-104](https://github.com/user-attachments/assets/822b9ad5-d724-4927-ad07-754a0bda6335)

## Литература
- М.А. Кройц, О.А. Морозов - Методы фильтрации и линейного предсказания в цифровой обработке сигналов
